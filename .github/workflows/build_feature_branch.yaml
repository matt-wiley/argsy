name: Build Package
on:
  push:
    branches-ignore:
      - "main"

jobs:
#   test:
#     name: Run Tests
#     runs-on: ubuntu-latest
#     container: python:3.9-slim
#     steps:
#       - uses: actions/checkout@v2
#       - name: Run Unit Tests
#         run: | 
#           ./build_scripts.sh pip
#           ./build_scripts.sh test
  build:
    # needs: [test]
    name: Build Wheel
    runs-on: ubuntu-latest
    container: python:3.9-slim
    steps:
      - uses: actions/checkout@v2
        with:
          fetch-depth: '0'
      # - name: Get Dependencies
      #   if: ${{ !cancelled() && !failure() }}
      #   run: |
      #     ./build_scripts.sh pip
      - id: next-tag
        name: Generate Next SemVer Tag
        uses: anothrNick/github-tag-action@1.36.0
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          WITH_V: true
          DRY_RUN: true
      - name: Execute Wheel Build 
        if: ${{ !cancelled() && !failure() }}
        run: |
          echo "tag => ${{ steps.next-tag.outputs.tag }}"
          echo "new_tag => ${{ steps.next-tag.outputs.new_tag }}"
          echo "part => ${{ steps.next-tag.outputs.part }}"
          # ./build_scripts.sh build
